<#assign contacts = reqDoc.vpoContact>

<#assign vendor_contact = 'nothing'>
<#if contacts[0]??>
  <#list contacts as contact>
    <#if (contact.position!'')?lower_case?contains('poco')>
      <#assign vendor_contact = '<strong>Ansprechpartner:</strong> ${(contact.title.name)!""} ${(contact.firstName)!""} ${(contact.lastName)!""}'>
      <#assign vendor_contact_tel = 'Tel: ${(contact.telNo)!""}'>
      <#assign vendor_contact_fax = 'Fax: ${(contact.faxNo)!""}'>
      <#assign vendor_contact_email = 'Email: ${(contact.email)!""}'>
    </#if>
  </#list>
</#if>

<#if vendor_contact == 'nothing'>
  <#if contacts[0]??>
    <#list contacts as contact>
      <#if (contact.contactTypeIdValue!'' == 'Notified') && (contact.fromPartyType!'' == 'vendor')>
        <#assign vendor_contact = '<strong>Ansprechpartner:<strong/> ${(contact.title.name)!""} ${(contact.firstName)!""} ${(contact.lastName)!""}'>
        <#assign vendor_contact_tel = 'Tel: ${(contact.telNo)!""}'>
        <#assign vendor_contact_fax = 'Fax: ${(contact.faxNo)!""}'>
        <#assign vendor_contact_email = 'Email: ${(contact.email)!""}'>
      </#if>
    </#list>
  </#if>
</#if>

<#if vendor_contact == 'nothing'>
  <#assign vendor_contact = '<strong>Ansprechpartner:</strong> (no designated contact!)'>
  <#assign vendor_contact_tel = 'Tel: (no designated contact!)'>
  <#assign vendor_contact_fax = 'Fax: (no designated contact!)'>
  <#assign vendor_contact_email = 'Email: (no designated contact!)'>
</#if>

<#assign from_contact = 'Import Department'>
<#assign parties=reqDoc.parties>
<#if parties[0]??>
  <#list parties as party>
    <#assign contact_type = party.partyNamName!'catch'>
	  <#assign contact_name = party.contactUser.firstName!'catch'>
	  <#assign contact_lastname = party.contactUser.lastName!'catch'>
    <#if (contact_type == 'Import') && (contact_name == 'catch') && (contact_lastname != 'catch')>
	    <#assign from_contact = '${contact_name} ${contact_lastname}'>
	  </#if>
  </#list>
</#if>

<#assign shipments=reqDoc.vpoShip>
<#if shipments?size gt 1>
  <#assign opening = 'Sehr geehrte Damen und Herren, wir bitten, mehrere Container wie folgt beim Lieferanten zu übernehmen:'>
<#else>
  <#assign opening = 'Sehr geehrte Damen und Herren, wir bitten, einen Container wie folgt beim Lieferanten zu übernehmen:'>
  <#assign container1=(shipments[0].noOfContainer)!0>
  <#assign container2=(shipments[0].noOfContainer2)!0>
  <#assign container3=(shipments[0].custNumber2)!0>
  <#if (container1 + container2 + container3) gt 1>
    <#assign opening = 'Sehr geehrte Damen und Herren, wir bitten, mehrere Container wie folgt beim Lieferanten zu übernehmen:'>    
  </#if>
</#if>

${opening}<br /><br />

Order-Nr.: ${(reqDoc.customerVpoRef)!""}<br /><br />

<#list shipments as shipment>
  <#assign shipping_date = shipment.shipmentDate>
  <#assign shipping_date_str = shipping_date.format("DD/MM/YYYY")>
  <#assign awesome_shipping_date = 'Shipment Date: ${shipping_date_str}'>
  <#assign port_of_loading = 'Port of Loading: ${(shipment.portOfLoading.name)!""}'>
  <#assign container1 = (shipment.noOfContainer)!0>
  <#assign container2 = (shipment.noOfContainer2)!0>
  <#assign container3 = (shipment.custNumber2)!0>
  
  <#if shipments?size gt 1>
    <#assign the_shipmentNo = 'Shipment No: ${shipment.shipmentNo}'>
    ${the_shipmentNo}<br />
  </#if>
  
  ${awesome_shipping_date}<br />
  ${port_of_loading}<br />
  
  <#if container1 gt 0>
    <#assign container1name = 'Anzahl ${(shipment.containerType.name)!""}:'>
    ${container1name} ${container1}<br />
  </#if>
  
  <#if container2 gt 0>
    <#assign container2name = 'Anzahl ${(shipment.containerType2.name)!""}:'>
    ${container2name} ${container2}<br />
  </#if>
  
  <#if container3 gt 0>
    <#assign container3name = 'Anzahl ${(shipment.custCodelist2.name)!""}:'>
    ${container3name} ${container3}<br />
  </#if>
  
  Bestimmungshafen: ${(shipment.portOfDischarge.name)!""} <br />
  Lagerhaus: ${(shipment.finalDestination.name)!""} <br /><br />
  
</#list>

Verschiffung nicht mehr als zwei Wochen vorher<br />
<br />
Lieferant: ${(reqDoc.vendorName)!""}<br />
${vendor_contact} <br />
${vendor_contact_tel} <br />
${vendor_contact_fax} <br />
${vendor_contact_email} <br />
<br />
Incoterm: ${(reqDoc.incoterm.name)!""}<br />
<br />
Für Rückfragen stehen wir Ihnen gerne zur Verfügung.<br />
<br />
Mit freundlichen Grüßen<br />
<br />
${from_contact} <br />
POCO Service AG
